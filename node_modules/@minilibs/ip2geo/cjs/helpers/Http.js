'use strict';

var Console = require('./Console.js');

const Http = async (endpoint) => {
    if (typeof window === 'undefined') {
        try {
            const fetchModule = await Promise.resolve().then(function () { return require('../node_modules/node-fetch/src/index.js'); });
            const fetch = fetchModule.default;
            const request = await fetch(endpoint);
            const response = await request.json();
            // @ts-ignore
            const isOk = response?.success && response?.ip;
            if (isOk)
                return response;
            else
                return null;
        }
        catch (error) {
            Console.Error('Http', error);
            return null;
        }
    }
    else {
        try {
            const request = await fetch(endpoint);
            const response = await request.json();
            const isOk = response?.success && response?.ip;
            if (isOk)
                return response?.ip;
            else
                return null;
        }
        catch (error) {
            Console.Error('Http', error);
            return null;
        }
    }
};

module.exports = Http;
